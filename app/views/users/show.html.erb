<div class="flexbox-container">
  <div id="profile-sidebar">
    <%= cl_image_tag(@user.photo.url(:bright_face), class: "avatar-large") %>
    <h2><%= @user.first_name %> <%= @user.last_name %></h2>
    <h5><%= @user.community_level %></h5>
    <h5><%= @user.ability %></h5>
    <% if @user == current_user %>
    <div class="photo-form">
      <%= simple_form_for(@user) do |f| %>
        <%= f.input :photo, label: false, class: "form-control" %>
        <%= f.button :submit, "Update Photo", class: "btn btn-success"  %>
      <% end %>
    </div>
  <% end %>
     <% if @user == current_user %>
      <%= simple_form_for(@user) do |f| %>
        <%= f.input :ability, label: false, class: "form-control" %>
        <%= f.button :submit, "Update Ability", class: "btn btn-success"  %>
      <% end %>
    <% end %>
  </div>
  <div id="profile-container">
    <div class="row profile-content-container">
      <div class="col-xs-12">
        <div class="box-profile-content">
          <h3 class="text-center">About Me</h3>
          <%= render 'users/bio', user: @user  %>
          <%= render 'users/form', user: @user  %>
        </div>
      </div>
    </div>
    <div class="row profile-content-container">
      <div class="col-xs-12">
        <div class="box-profile-content">
          <h3 class="text-center"><%= @user.first_name %>'s Created Routes</h3>
          <ul>
            <% @user.routes.each do |route| %>
            <li><%= route.name %></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
    <div class="row profile-content-container">
      <div class="col-xs-12">
        <% if @user.reviews.any? %>
          <div class="box-profile-content reviews">
            <h3><%= @user.first_name %>'s Reviews</h3>
            <% reviews = @user.reviews.reverse %>
            <% reviews.each do |review| %>

            <div class="review-box">
              <h4> <%= review.route.name %> |
                <% review.rating.times do %>
                  <i class="fas fa-star"></i>
                  <% end %>
                  <% (5-review.rating).times do %>
                  <i class="far fa-star"></i>
                <% end %>
              </h4>
              <p><%= review.content %></p>
              <%= link_to "", route_path(review.route) %>
            </div>
            <% end %>
          </div>
      <% end %>
      </div>
    </div>
  </div>
</div>

<script>

  <% if @user == current_user %>
    const bioText = document.getElementById("bio-text");
    const inputField = document.getElementById("formTarget")

    bioText.addEventListener("click", (event) => {
      console.log(event);
      event.currentTarget.classList.toggle('hidden');
      inputField.classList.toggle('hidden');
    });

    const form = document.getElementById("bio-form");

    form.addEventListener("submit", () => {
      bioText.classList.toggle("hidden");
      inputField.classList.toggle("hidden");
      console.log("just submitted");
    })
  <% end %>

</script>

